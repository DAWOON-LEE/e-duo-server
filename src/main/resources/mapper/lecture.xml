<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.educator.eduo.lecture.model.mapper.LectureMapper">

	<resultMap id="lectureResult" type="com.educator.eduo.lecture.model.entity.Lecture">
		<id property="lectureId" column="lecture_id"/>
		<result property="courseId" column="course_id"/>
		<result property="lectureName" column="lecture_name"/>
		<result property="lectureDate" column="lecture_date"/>
		<result property="startTime" column="start_time"/>
		<result property="endTime" column="end_time"/>
		<result property="description" column="description"/>
		<result property="existAssignment" column="exist_assignment"/>		
		<result property="existTest" column="exist_test"/>		
		<result property="testType" column="test_type"/>		
	</resultMap>
	
	<resultMap id="lectureAllResult" type="LectureResultDto">
		<association property="lecture" column="lecture_id" javaType="Lecture" resultMap="lectureResult"/>
	</resultMap>

	<insert id="insertLecture" parameterType="Lecture">
		INSERT INTO lecture (lecture_name, lecture_date, start_time, end_time, description, exist_assignment, exist_test, test_type)
		VALUES (#{lectureName}, #{lectureDate}, #{startTime}, #{endTime}, #{description}, #{existAssignment}, #{existTest}, #{testType});
	</insert>

	<update id="updateLecture" parameterType="Lecture">
		UPDATE lecture
		<set>
			<if test="lectureName != null">
				lecture_name = #{lectureName},
			</if>
			<if test="lectureDate != null">
				lecture_date = #{lectureDate},
			</if>
			<if test="startTime != null">
				start_time = #{startTime},
			</if>
			<if test="endTime != null">
				end_time = #{endTime},
			</if>
			<if test="description != null">
				description = #{description},
			</if>
			<if test="lectureOrder != null">
				lecture_order = {lectureOrder}
			</if>
		</set>
		WHERE lecture_id = #{lectureId};
	</update>
	
	<delete id="deleteLecture" parameterType="string">
		DELETE FROM lecture
		where lecture_id = #{lectureId};
	</delete>
	<select id="selectAllLecture" parameterType="string" resultMap="lectureAllResult">
		SELECT lecture_id, course_id, lecture_name, lecture_date, start_time, end_time, description, exist_assignment, exist_test, test_type
		FROM lecture
		where course_id = #{courseId};
	</select>
	
	<select id="selectSugangLecture" parameterType="string" resultMap="lectureAllResult">
		SELECT lecture_id, exist_assignment
		FROM lecture
		where course_id = #{courseId} and lecture_date >= sysdate();
	</select>

	<insert id="insertAllLecture" parameterType="java.util.List">
		INSERT INTO lecture( course_id, lecture_name, lecture_date, start_time, end_time, description, exist_assignment, exist_test, test_type)
		VALUES
		<foreach collection="list" item="item" separator=",">
			( #{item.courseId}, #{item.lectureName}, #{item.lectureDate}, #{item.startTime}, #{item.endTime}, #{item.description},
			#{item.existAssignment}, #{item.existTest}, #{item.testType})
		</foreach>
	</insert>
</mapper>